(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-becf8324"],{"0239":function(e,t,a){"use strict";a("ea1b")},"56fe":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"search-div"},[a("el-row",{staticStyle:{display:"flex"}},[a("el-button",{attrs:{type:"success",icon:"el-icon-plus",size:"mini"},on:{click:function(t){e.dialogVisible=!0}}},[e._v("添 加")]),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(t){return e.batchRemove()}}},[e._v("批量删除")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:e.tableData,stripe:""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection"}}),a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[a("el-form-item",{attrs:{label:"任务类型"}},[a("span",[e._v(e._s(t.row.kindName))])]),a("el-form-item",{attrs:{label:"目标次数 / 时长"}},[a("span",[e._v(e._s(t.row.targetNum))])]),a("el-form-item",{attrs:{label:"奖励"}},[a("span",[e._v(e._s(t.row.reward))])]),a("el-form-item",{attrs:{label:"结束日期"}},[a("span",[e._v(e._s(t.row.deadline))])]),a("el-form-item",{attrs:{label:"开始日期"}},[a("span",[e._v(e._s(null===t.row.releaseDate?"请先发布":t.row.releaseDate))])]),a("el-form-item",{attrs:{label:"状态"}},[a("span",[e._v(e._s(t.row.released?"已发布":"未发布"))])]),a("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"任务详细描述"}},[a("span",[e._v(e._s(t.row.description))])]),a("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"任务上传文件"}},[a("el-image",{staticStyle:{width:"200px",height:"200px"},attrs:{src:t.row.pictureURL}})],1)],1)]}}])}),a("el-table-column",{attrs:{label:"任务编号",prop:"id"}}),a("el-table-column",{attrs:{label:"任务名",prop:"missionName"}}),a("el-table-column",{attrs:{label:"简短描述"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.description.substring(0,7).concat("...")))]}}])}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{disabled:t.row.released,type:"warning",icon:"el-icon-edit",size:"mini",title:"发布",plain:""},on:{click:function(a){return e.releaseMission(t.row.id)}}},[e._v("发 布")]),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini",title:"删除",plain:""},on:{click:function(a){return e.removeDataById(t.row.id)}}},[e._v("删 除")])]}}])})],1),a("el-pagination",{staticStyle:{padding:"30px 0","text-align":"center"},attrs:{"current-page":e.page,total:e.total,"page-size":e.limit,layout:"total, prev, pager, next, jumper"},on:{"current-change":e.fetchData}}),a("el-dialog",{attrs:{title:"添加任务",visible:e.dialogVisible,width:"40%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"dataForm",staticStyle:{"padding-right":"40px"},attrs:{model:e.mission,"label-width":"150px",size:"small"}},[a("el-form-item",{attrs:{label:"任务名称"}},[a("el-input",{model:{value:e.mission.missionName,callback:function(t){e.$set(e.mission,"missionName",t)},expression:"mission.missionName"}})],1),a("el-form-item",{attrs:{label:"任务描述"}},[a("el-input",{model:{value:e.mission.description,callback:function(t){e.$set(e.mission,"description",t)},expression:"mission.description"}})],1),a("el-form-item",{attrs:{label:"任务类型"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.mission.kind,callback:function(t){e.$set(e.mission,"kind",t)},expression:"mission.kind"}},[a("el-option",{attrs:{label:"上传文件任务",value:"0"}}),a("el-option",{attrs:{label:"上传视频任务",value:"1"}}),a("el-option",{attrs:{label:"聊天任务",value:"2"}}),a("el-option",{attrs:{label:"视频通话任务",value:"3"}})],1)],1),2==e.mission.kind||3==e.mission.kind?a("el-form-item",{attrs:{label:"目标次数 / 时长"}},[a("el-input",{model:{value:e.mission.targetNum,callback:function(t){e.$set(e.mission,"targetNum",t)},expression:"mission.targetNum"}})],1):e._e(),a("el-form-item",{attrs:{label:"任务奖励"}},[a("el-input",{model:{value:e.mission.reward,callback:function(t){e.$set(e.mission,"reward",t)},expression:"mission.reward"}})],1),a("el-form-item",{attrs:{label:"结束日期"}},[a("el-date-picker",{attrs:{format:"yyyy-MM-dd","value-format":"yyyy-MM-dd HH:mm:ss",type:"date",placeholder:"选择日期"},model:{value:e.mission.deadline,callback:function(t){e.$set(e.mission,"deadline",t)},expression:"mission.deadline"}})],1),a("el-form-item",{attrs:{label:"上传任务描述文件"}},[a("el-upload",{staticClass:"upload-demo",attrs:{drag:"",action:"http://localhost:8080/mission/upload",multiple:"","http-request":e.upload,accept:".jpg,.png,.mp4","before-upload":e.beforeFileUpload,"on-error":e.removeErrorUploadFile}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),a("em",[e._v("点击上传")])]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png/mp4文件，且不超过20MB")])])],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small",icon:"el-icon-refresh-right"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",icon:"el-icon-check",size:"small"},on:{click:function(t){return e.save()}}},[e._v("确 定")])],1)],1)],1)},n=[],s=(a("d3b7"),a("159b"),a("99af"),a("b775")),o="/mission",l={getPageList:function(e,t,a){return Object(s["a"])({url:"".concat(o,"/").concat(e,"/").concat(t),method:"get",params:a})},batchRemove:function(e){return Object(s["a"])({url:"".concat(o,"/batchRemove"),method:"delete",data:e})},releaseMission:function(e){return Object(s["a"])({url:"".concat(o,"/releaseMission/").concat(e),method:"post"})},removeById:function(e){return Object(s["a"])({url:"".concat(o,"/remove/").concat(e),method:"delete"})},save:function(e){return Object(s["a"])({url:"".concat(o,"/save"),method:"post",data:e})},upload:function(e){return Object(s["a"])({url:"".concat(o,"/upload"),method:"post",data:e})}},r={name:"MissionList",data:function(){return{isLoading:!0,total:0,page:1,limit:10,searchObj:{},tableData:[],multipleSelection:[],mission:{},dialogVisible:!1}},created:function(){this.fetchData()},methods:{fetchData:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.page=t,l.getPageList(this.page,this.limit,this.searchObj).then((function(t){e.tableData=t.data.records,e.total=t.data.total,e.isLoading=!1}))},resetData:function(){this.searchObj={},this.fetchData()},handleSelectionChange:function(e){this.multipleSelection=e},batchRemove:function(){var e=this;0!==this.multipleSelection.length?this.$confirm("此操作将永久删除该记录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t=[];return e.multipleSelection.forEach((function(e){t.push(e.id)})),l.batchRemove(t)})).then((function(t){e.fetchData(),e.$message.success(t.message)})):this.$message.warning("请选择要删除的记录！")},removeDataById:function(e){var t=this;this.$confirm("此操作将永久删除该记录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return l.removeById(e)})).then((function(e){t.fetchData(t.page),t.$message.success(e.message||"删除成功")}))},releaseMission:function(e){var t=this;this.$confirm("此操作将发布该任务, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return l.releaseMission(e)})).then((function(e){t.fetchData(t.page),t.$message.success(e.message||"发布成功")}))},save:function(){var e=this;l.save(this.mission).then((function(t){e.$message.success(t.message||"操作成功"),e.dialogVisible=!1,e.fetchData(e.page),e.mission={}}))},upload:function(e){var t=this,a=new FormData;a.append("file",e.file),l.upload(a).then((function(e){t.mission.pictureURL=e.data}))},beforeFileUpload:function(e){var t=e.size/1024/1024<20;return t||this.$message.error("上传文件大小不能超过 20MB!"),t},removeErrorUploadFile:function(e,t){console.log(e),console.log(t)}}},c=r,u=(a("0239"),a("2877")),m=Object(u["a"])(c,i,n,!1,null,null,null);t["default"]=m.exports},ea1b:function(e,t,a){}}]);